import{_ as P,u as I,b as x}from"./C-ohEz9G.js";import{_ as y,c as k}from"./BrupjIEG.js";import{_ as l,t as c,v as a,x as e,y as _,P as g,z as h,Q as f,R as v,L as m,B as A,M as $,r as O,S}from"./C36Jqkuh.js";import{u as B}from"./CB-gCJTg.js";import{u as w}from"./CfhJ4hzW.js";import"./0MDbMjnL.js";const T={props:{info:Object}},E={class:"cafe-header"},F=e("div",{class:"cafe-header__img"},null,-1),L={class:"cafe-header__content"},j={class:"cafe-header__name"},N={class:"cafe-header__address"},M={class:"cafe-header__info"},q={class:"cafe-header__text"},Y={class:"cafe-header__info"},z={class:"cafe-header__text"};function D(n,o,t,r,d,s){const i=y;return c(),a("div",E,[F,e("div",L,[e("h2",j,_(t.info.name),1),e("p",N,_(t.info.address),1),e("div",M,[e("div",{class:g(`cafe-header__status ${t.info.status?"cafe-header__status_open":""}`)},null,2),e("p",q,_(t.info.status?"Open":"Closed"),1)]),e("div",Y,[h(i,{color:"#757575"}),e("p",z,"Waiting "+_(t.info.waitingTime)+" min",1)])])])}const V=l(T,[["render",D]]),H={props:{menu:Object,activeChapter:String},data(){return{}},methods:{scrollEvent(){var n=window.document.querySelector(".menu-nav");n.classList.toggle("menu-nav_sticky",window.scrollY>373)}},beforeMount(){window.addEventListener("scroll",this.scrollEvent,!1)},unmounted(){window.removeEventListener("scroll",this.scrollEvent,!1)}},R={class:"menu-nav"},J={class:"menu-nav__content"},Q=["href"];function U(n,o,t,r,d,s){return c(),a("div",R,[e("div",J,[(c(!0),a(f,null,v(t.menu,i=>(c(),a("a",{href:`#${i.id}`,class:g(`menu-nav__link ${i.id==t.activeChapter?"menu-nav__link_active":""}`),key:i.id},_(i.name),11,Q))),128))])])}const W=l(H,[["render",U]]),G={props:{position:Object,onOpenPos:Function},data(){var n,o;return{name:((n=this.position)==null?void 0:n.name)||"",cost:((o=this.position)==null?void 0:o.cost)||0}},computed:{costString(){return this.cost.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}},methods:{openPosition(){this.onOpenPos(this.position)}}},K={class:"position"},X={class:"position__content"},Z={class:"position__img"},tt={class:"position__name"};function nt(n,o,t,r,d,s){const i=P;return c(),a("div",K,[e("div",X,[e("div",Z,[h(i,{color:"#f2f2f2"})]),e("h4",tt,_(d.name),1)]),e("button",{onClick:o[0]||(o[0]=(...u)=>s.openPosition&&s.openPosition(...u)),class:"position__btn"},_(s.costString)+" ₸",1)])}const ot=l(G,[["render",nt]]),et={props:{positions:Array,onOpenPos:Function}},st={class:"positions"};function it(n,o,t,r,d,s){const i=ot;return c(),a("div",st,[(c(!0),a(f,null,v(t.positions,u=>(c(),m(i,{key:u.id,position:u,onOpenPos:t.onOpenPos},null,8,["position","onOpenPos"]))),128))])}const dt=l(et,[["render",it]]),ct={props:{chapter:Object,setActive:Function,onOpenPos:Function},data(){var n,o,t;return{id:((n=this.chapter)==null?void 0:n.id)||"",name:((o=this.chapter)==null?void 0:o.name)||"",positions:((t=this.chapter)==null?void 0:t.positions)||[]}},methods:{handleScroll(){const n=window.document.getElementById(this.id);let o=window.scrollY,t=n.offsetTop,r=n.offsetHeight;o>=t&&o<t+r&&this.setActive(this.id)}},beforeMount(){window.addEventListener("scroll",this.handleScroll)},unmounted(){window.removeEventListener("scroll",this.handleScroll)}},at=["id"],rt={class:"chapter__title"};function _t(n,o,t,r,d,s){const i=dt;return c(),a("div",{class:"chapter",id:d.id},[e("h3",rt,_(d.name),1),h(i,{positions:d.positions,onOpenPos:t.onOpenPos},null,8,["positions","onOpenPos"])],8,at)}const ut=l(ct,[["render",_t]]),lt={props:{menu:Object,onOpenPos:Function},data(){return{activeChapter:"0"}},methods:{handleActive(n){this.activeChapter=n}}},ht={class:"menu"};function pt(n,o,t,r,d,s){const i=W,u=ut;return c(),a("div",ht,[h(i,{menu:t.menu,activeChapter:d.activeChapter},null,8,["menu","activeChapter"]),(c(!0),a(f,null,v(t.menu,p=>(c(),m(u,{key:p.id,chapter:p,setActive:s.handleActive,onOpenPos:t.onOpenPos},null,8,["chapter","setActive","onOpenPos"]))),128))])}const mt=l(lt,[["render",pt]]),ft={props:{totalCost:Number},computed:{costString(){return(this.totalCost?this.totalCost:0).toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}},methods:{openBusket(){this.$router.push("/busket")}}},vt={class:"cafe-busket"},gt={class:"cafe-busket__content"},bt={class:"cafe-busket__cost"};function Ct(n,o,t,r,d,s){return c(),a("div",vt,[e("div",gt,[e("p",bt,[A("К оплате: "),e("b",null,_(s.costString)+" ₸",1)]),e("div",{onClick:o[0]||(o[0]=(...i)=>s.openBusket&&s.openBusket(...i)),class:"btn cafe-busket__btn"},"Смотреть заказ")])])}const $t=l(ft,[["render",Ct]]),kt={props:{position:Object},computed:{posInfo(){return this.position}}},It={class:"position-header"},At=e("div",{class:"position-header__img"},null,-1),Pt={class:"position-header__content"},xt={class:"position-header__name"},yt={class:"position-header__info"};function Ot(n,o,t,r,d,s){return c(),a("div",It,[At,e("div",Pt,[e("h2",xt,_(s.posInfo.name),1),e("p",yt,_(s.posInfo.info),1)])])}const St=l(kt,[["render",Ot]]),Bt={props:{item:Object,addAddon:Function,delAddon:Function},data(){return{isChoose:!1}},methods:{toogleInput(n){this.isChoose=!this.isChoose,console.log(this.isChoose),this.isChoose?this.addAddon(this.item):this.delAddon(this.item)}}},wt={class:"addons__field"},Tt=["name","id"],Et=["for"],Ft={class:"addons__cost"};function Lt(n,o,t,r,d,s){return c(),a("div",wt,[e("input",{onClick:o[0]||(o[0]=(...i)=>s.toogleInput&&s.toogleInput(...i)),type:"checkbox",name:t.item.id,id:t.item.id,class:"addons__checkbox"},null,8,Tt),e("label",{for:t.item.id,class:"addons__label"},_(t.item.name),9,Et),e("p",Ft,"+ "+_(t.item.cost)+" ₸",1)])}const jt=l(Bt,[["render",Lt]]),Nt={props:{addons:Array,addAddon:Function,delAddon:Function}},Mt={class:"addons"},qt=e("h3",{class:"addons__title"},"Добавки",-1),Yt={class:"addons__content"};function zt(n,o,t,r,d,s){const i=jt;return c(),a("div",Mt,[qt,e("div",Yt,[(c(!0),a(f,null,v(t.addons,u=>(c(),m(i,{key:u.id,item:u,addAddon:t.addAddon,delAddon:t.delAddon},null,8,["item","addAddon","delAddon"]))),128))])])}const Dt=l(Nt,[["render",zt]]),Vt={props:{ingredient:Object,addIngred:Function,delIngred:Function},data(){var n,o,t;return{name:((n=this.ingredient)==null?void 0:n.name)||"",id:((o=this.ingredient)==null?void 0:o.id)||"",list:((t=this.ingredient)==null?void 0:t.list)||[],value:null}},methods:{onChange(n){this.value&&this.delIngred(this.value),this.value=n,this.addIngred(this.value)}}},Ht={class:"ingredient"},Rt={class:"ingredient__title"},Jt=["onClick","name","id"],Qt=["for"],Ut={class:"ingredient__cost"};function Wt(n,o,t,r,d,s){return c(),a("div",Ht,[e("h3",Rt,_(d.name),1),(c(!0),a(f,null,v(d.list,i=>(c(),a("div",{class:"ingredient__field",key:i.id},[e("input",{onClick:u=>s.onChange(i),type:"radio",name:d.id,id:i.id,class:"ingredient__radio"},null,8,Jt),e("label",{for:i.id,class:"ingredient__label"},_(i.name),9,Qt),e("p",Ut,"+ "+_(i.cost)+" ₸",1)]))),128))])}const Gt=l(Vt,[["render",Wt]]),Kt={props:{position:Object,addAddon:Function,delAddon:Function,addIngred:Function,delIngred:Function},data(){var n,o;return{addons:((n=this.position)==null?void 0:n.addons)||[],ingredients:((o=this.position)==null?void 0:o.ingredients)||[]}}},Xt={class:"edits"},Zt={class:"edit__engredients"};function tn(n,o,t,r,d,s){const i=Dt,u=Gt;return c(),a("div",Xt,[d.addons.length!=0?(c(),m(i,{key:0,addons:d.addons,addAddon:t.addAddon,delAddon:t.delAddon},null,8,["addons","addAddon","delAddon"])):$("",!0),e("div",Zt,[(c(!0),a(f,null,v(d.ingredients,p=>(c(),m(u,{key:p.id,ingredient:p,addIngred:t.addIngred,delIngred:t.delIngred},null,8,["ingredient","addIngred","delIngred"]))),128))])])}const nn=l(Kt,[["render",tn]]),on={props:{cost:Number,count:Number,plusCount:Function,minusCount:Function,addToBusket:Function},data(){return{}},computed:{totalCost(){var n=this.cost*this.count;return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}}},en={class:"button-bar"},sn={class:"button-bar__text"},dn={class:"button-bar__control"},cn={class:"button-bar__count"},an=["disabled"],rn={class:"button-bar__count-text"};function _n(n,o,t,r,d,s){return c(),a("div",en,[e("p",sn,[A("Итого: "),e("b",null,_(s.totalCost),1)]),e("div",dn,[e("div",cn,[e("button",{onClick:o[0]||(o[0]=(...i)=>t.minusCount&&t.minusCount(...i)),class:g(`button-bar__count-btn ${t.count===1?"button-bar__count-btn_dis":""}`),disabled:t.count===1},"-",10,an),e("p",rn,_(t.count)+" шт",1),e("button",{onClick:o[1]||(o[1]=(...i)=>t.plusCount&&t.plusCount(...i)),class:"button-bar__count-btn"},"+")]),e("button",{onClick:o[2]||(o[2]=(...i)=>t.addToBusket&&t.addToBusket(...i)),class:"button-bar__btn"},"Добавить")])])}const un=l(on,[["render",_n]]),ln={data(){return{touchStart:0,orderAddons:[],orderIngredients:[],count:1}},props:{position:Object,isOpen:Boolean,onClose:Function},methods:{addAddon(n){this.orderAddons.push(n)},delAddon(n){const o=this.orderAddons.findIndex(t=>t.id===n.id);this.orderAddons.splice(o,1)},addIngred(n){this.orderIngredients.push(n)},delIngred(n){const o=this.orderIngredients.findIndex(t=>t.id===n.id);this.orderIngredients.splice(o,1)},plusCount(){this.count+=1},minusCount(){this.count-=1},clearData(){this.orderAddons=[],this.orderIngredients=[],this.count=1},closePopup(n){this.onClose(),this.clearData(),setTimeout(()=>{n.style.top="auto",n.style.bottom=0},1e3)},addToBusket(){const{addItem:n}=I(),o=document.querySelector(".cafe-popup"),t={id:this.orderItem.id,name:this.orderItem.name,cost:this.orderItem.cost,count:this.count,totalCost:this.totalCost,addons:this.orderAddons,ingredients:this.orderIngredients};n(t),this.clearData(),this.closePopup(o)},onTouchStart(n){console.log(n),this.touchStart=n.changedTouches[0].clientY},onTouchMove(n,o){var t=o.targetTouches[0];t.clientY>=this.touchStart&&(n.style.bottom=0-(t.clientY-this.touchStart)+"px")},onTouchEnd(n,o){var t=o.changedTouches[0];t.clientY>150+this.touchStart?this.closePopup(n):(n.style.top="auto",n.style.bottom=0)}},computed:{totalCost(){let n=this.orderItem.cost;return this.orderAddons.forEach(o=>{n+=o.cost}),this.orderIngredients.forEach(o=>{n+=o.cost}),n},orderItem(){return{id:this.position.id,name:this.position.name,cost:this.position.cost}}},mounted(){const n=document.querySelector(".cafe-popup__drag-zone"),o=document.querySelector(".cafe-popup");o.style.bottom=0,n.addEventListener("touchstart",t=>{this.onTouchStart(t)}),n.addEventListener("touchmove",t=>{this.onTouchMove(o,t)}),n.addEventListener("touchend",t=>{this.onTouchEnd(o,t)})},beforeUnmount(){const n=document.querySelector(".cafe-popup__drag-zone"),o=document.querySelector(".cafe-popup");n.removeEventListener("touchstart",t=>{this.onTouchStart(t)}),n.removeEventListener("touchmove",t=>{this.onTouchMove(o,t)}),n.removeEventListener("touchend",t=>{this.onTouchEnd(o,t)})}},hn=e("div",{class:"cafe-popup__drag-zone"},[e("div",{class:"cafe-popup__drag-bar"})],-1),pn={class:"cafe-popup__content"};function mn(n,o,t,r,d,s){var b,C;const i=St,u=nn,p=un;return c(),a("div",{class:g(`cafe-popup ${t.isOpen?"cafe-popup_show":""}`)},[hn,e("div",pn,[h(i,{position:t.position},null,8,["position"]),(b=t.position)!=null&&b.addons||(C=t.position)!=null&&C.ingredients?(c(),m(u,{key:0,position:t.position,addAddon:s.addAddon,delAddon:s.delAddon,addIngred:s.addIngred,delIngred:s.delIngred},null,8,["position","addAddon","delAddon","addIngred","delIngred"])):$("",!0),h(p,{cost:s.totalCost,count:d.count,plusCount:s.plusCount,minusCount:s.minusCount,addToBusket:s.addToBusket},null,8,["cost","count","plusCount","minusCount","addToBusket"])])],2)}const fn=l(ln,[["render",mn]]),vn={data(){return{cafe:{},isPopup:!1,position:{}}},computed:{busket(){const{getBusket:n}=I();return n||[]},totalCost(){let n=0;return this.busket.forEach(o=>{n+=o.totalCost*o.count}),n}},methods:{tooglePopup(){this.isPopup=!this.isPopup,this.isPopup?document.body.style.overflow="hidden":document.body.style.overflow="auto"},openPosition(n){this.position=n,this.tooglePopup()}},async beforeMount(){const{setCurCafe:n}=B(),{setLoader:o}=w(),t=O({});let r=JSON.parse((this._.provides[S]||this.$route).query.cafeId);o(!0),await k.getCafeId(r);const{data:d}=await k.getCafeId(r);t.value=await(d==null?void 0:d.value),o(!1),n(t.value),this.cafe=t.value}},gn={class:"cafe"};function bn(n,o,t,r,d,s){const i=x,u=V,p=mt,b=$t,C=fn;return c(),a("div",gn,[h(i),h(u,{info:d.cafe},null,8,["info"]),h(p,{menu:d.cafe.menu,onOpenPos:s.openPosition},null,8,["menu","onOpenPos"]),s.busket.length>0?(c(),m(b,{key:0,totalCost:s.totalCost},null,8,["totalCost"])):$("",!0),h(C,{onClose:s.tooglePopup,isOpen:d.isPopup,position:d.position},null,8,["onClose","isOpen","position"]),d.isPopup?(c(),a("div",{key:1,class:g(`cafe__bg ${d.isPopup?"cafe__bg_show":""}`)},null,2)):$("",!0)])}const xn=l(vn,[["render",bn]]);export{xn as default};
