import{_ as P,u as A,b as y}from"./sGE7JaRm.js";import{_ as O,c as I}from"./BtaiPKAw.js";import{_ as l,t as c,v as a,x as o,N as k,y as _,Q as b,z as p,R as f,S as g,L as m,M as v,B as x,r as S,T as B}from"./m3p8uItU.js";import{u as T}from"./DJfDUNfk.js";import{u as w}from"./C8ZOEeOK.js";import"./CStLU7k7.js";const E={props:{info:Object}},F={class:"cafe-header"},L={class:"cafe-header__content"},j={class:"cafe-header__name"},N={class:"cafe-header__address"},M={class:"cafe-header__info"},q={class:"cafe-header__text"},z={class:"cafe-header__info"},Y={class:"cafe-header__text"};function D(n,e,t,r,d,s){const i=O;return c(),a("div",F,[o("div",{class:"cafe-header__img",style:k(`background-image: url(${t.info.image})`)},null,4),o("div",L,[o("h2",j,_(t.info.name),1),o("p",N,_(t.info.address),1),o("div",M,[o("div",{class:b(`cafe-header__status ${t.info.status?"cafe-header__status_open":""}`)},null,2),o("p",q,_(t.info.status?"Open":"Closed"),1)]),o("div",z,[p(i,{color:"#757575"}),o("p",Y,"Waiting "+_(t.info.waitingTime)+" min",1)])])])}const V=l(E,[["render",D]]),H={props:{menu:Object,activeChapter:String},data(){return{}},methods:{scrollEvent(){var n=window.document.querySelector(".menu-nav");n.classList.toggle("menu-nav_sticky",window.scrollY>373)}},beforeMount(){window.addEventListener("scroll",this.scrollEvent,!1)},unmounted(){window.removeEventListener("scroll",this.scrollEvent,!1)}},R={class:"menu-nav"},J={class:"menu-nav__content"},Q=["href"];function U(n,e,t,r,d,s){return c(),a("div",R,[o("div",J,[(c(!0),a(f,null,g(t.menu,i=>(c(),a("a",{href:`#${i.id}`,class:b(`menu-nav__link ${i.id==t.activeChapter?"menu-nav__link_active":""}`),key:i.id},_(i.name),11,Q))),128))])])}const W=l(H,[["render",U]]),G={props:{position:Object,onOpenPos:Function},data(){var n,e,t;return{name:((n=this.position)==null?void 0:n.name)||"",cost:((e=this.position)==null?void 0:e.cost)||0,image:((t=this.position)==null?void 0:t.image)||""}},computed:{costString(){return this.cost.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}},methods:{openPosition(){this.onOpenPos(this.position)}}},K={class:"position"},X={class:"position__content"},Z={class:"position__name"};function tt(n,e,t,r,d,s){const i=P;return c(),a("div",K,[o("div",X,[o("div",{class:"position__img",style:k(`background-image: url(${t.position.image})`)},[t.position.image===""?(c(),m(i,{key:0,color:"#f2f2f2"})):v("",!0)],4),o("h4",Z,_(d.name),1)]),o("button",{onClick:e[0]||(e[0]=(...u)=>s.openPosition&&s.openPosition(...u)),class:"position__btn"},_(s.costString)+" ₸",1)])}const nt=l(G,[["render",tt]]),et={props:{positions:Array,onOpenPos:Function}},ot={class:"positions"};function st(n,e,t,r,d,s){const i=nt;return c(),a("div",ot,[(c(!0),a(f,null,g(t.positions,u=>(c(),m(i,{key:u.id,position:u,onOpenPos:t.onOpenPos},null,8,["position","onOpenPos"]))),128))])}const it=l(et,[["render",st]]),dt={props:{chapter:Object,setActive:Function,onOpenPos:Function},data(){var n,e,t;return{id:((n=this.chapter)==null?void 0:n.id)||"",name:((e=this.chapter)==null?void 0:e.name)||"",positions:((t=this.chapter)==null?void 0:t.positions)||[]}},methods:{handleScroll(){const n=window.document.getElementById(this.id);let e=window.scrollY,t=n.offsetTop,r=n.offsetHeight;e>=t&&e<t+r&&this.setActive(this.id)}},beforeMount(){window.addEventListener("scroll",this.handleScroll)},unmounted(){window.removeEventListener("scroll",this.handleScroll)}},ct=["id"],at={class:"chapter__title"};function rt(n,e,t,r,d,s){const i=it;return c(),a("div",{class:"chapter",id:d.id},[o("h3",at,_(d.name),1),p(i,{positions:d.positions,onOpenPos:t.onOpenPos},null,8,["positions","onOpenPos"])],8,ct)}const _t=l(dt,[["render",rt]]),ut={props:{menu:Object,onOpenPos:Function},data(){return{activeChapter:"0"}},methods:{handleActive(n){this.activeChapter=n}}},lt={class:"menu"};function ht(n,e,t,r,d,s){const i=W,u=_t;return c(),a("div",lt,[p(i,{menu:t.menu,activeChapter:d.activeChapter},null,8,["menu","activeChapter"]),(c(!0),a(f,null,g(t.menu,h=>(c(),m(u,{key:h.id,chapter:h,setActive:s.handleActive,onOpenPos:t.onOpenPos},null,8,["chapter","setActive","onOpenPos"]))),128))])}const pt=l(ut,[["render",ht]]),mt={props:{totalCost:Number},computed:{costString(){return(this.totalCost?this.totalCost:0).toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}},methods:{openBusket(){this.$router.push("/busket")}}},ft={class:"cafe-busket"},gt={class:"cafe-busket__content"},vt={class:"cafe-busket__cost"};function bt(n,e,t,r,d,s){return c(),a("div",ft,[o("div",gt,[o("p",vt,[x("К оплате: "),o("b",null,_(s.costString)+" ₸",1)]),o("div",{onClick:e[0]||(e[0]=(...i)=>s.openBusket&&s.openBusket(...i)),class:"btn cafe-busket__btn"},"Смотреть заказ")])])}const Ct=l(mt,[["render",bt]]),$t={props:{position:Object},computed:{posInfo(){return this.position}}},kt={class:"position-header"},It={class:"position-header__content"},At={class:"position-header__name"},xt={class:"position-header__info"};function Pt(n,e,t,r,d,s){return c(),a("div",kt,[o("div",{class:"position-header__img",style:k(`background-image: url(${s.posInfo.image})`)},null,4),o("div",It,[o("h2",At,_(s.posInfo.name),1),o("p",xt,_(s.posInfo.info),1)])])}const yt=l($t,[["render",Pt]]),Ot={props:{item:Object,addAddon:Function,delAddon:Function},data(){return{isChoose:!1}},methods:{toogleInput(n){this.isChoose=!this.isChoose,console.log(this.isChoose),this.isChoose?this.addAddon(this.item):this.delAddon(this.item)}}},St={class:"addons__field"},Bt=["name","id"],Tt=["for"],wt={class:"addons__cost"};function Et(n,e,t,r,d,s){return c(),a("div",St,[o("input",{onClick:e[0]||(e[0]=(...i)=>s.toogleInput&&s.toogleInput(...i)),type:"checkbox",name:t.item.id,id:t.item.id,class:"addons__checkbox"},null,8,Bt),o("label",{for:t.item.id,class:"addons__label"},_(t.item.name),9,Tt),o("p",wt,"+ "+_(t.item.cost)+" ₸",1)])}const Ft=l(Ot,[["render",Et]]),Lt={props:{addons:Array,addAddon:Function,delAddon:Function}},jt={class:"addons"},Nt=o("h3",{class:"addons__title"},"Добавки",-1),Mt={class:"addons__content"};function qt(n,e,t,r,d,s){const i=Ft;return c(),a("div",jt,[Nt,o("div",Mt,[(c(!0),a(f,null,g(t.addons,u=>(c(),m(i,{key:u.id,item:u,addAddon:t.addAddon,delAddon:t.delAddon},null,8,["item","addAddon","delAddon"]))),128))])])}const zt=l(Lt,[["render",qt]]),Yt={props:{ingredient:Object,addIngred:Function,delIngred:Function},data(){var n,e,t;return{name:((n=this.ingredient)==null?void 0:n.name)||"",id:((e=this.ingredient)==null?void 0:e.id)||"",list:((t=this.ingredient)==null?void 0:t.list)||[],value:null}},methods:{onChange(n){this.value&&this.delIngred(this.value),this.value=n,this.addIngred(this.value)}}},Dt={class:"ingredient"},Vt={class:"ingredient__title"},Ht=["onClick","name","id"],Rt=["for"],Jt={class:"ingredient__cost"};function Qt(n,e,t,r,d,s){return c(),a("div",Dt,[o("h3",Vt,_(d.name),1),(c(!0),a(f,null,g(d.list,i=>(c(),a("div",{class:"ingredient__field",key:i.id},[o("input",{onClick:u=>s.onChange(i),type:"radio",name:d.id,id:i.id,class:"ingredient__radio"},null,8,Ht),o("label",{for:i.id,class:"ingredient__label"},_(i.name),9,Rt),o("p",Jt,"+ "+_(i.cost)+" ₸",1)]))),128))])}const Ut=l(Yt,[["render",Qt]]),Wt={props:{position:Object,addAddon:Function,delAddon:Function,addIngred:Function,delIngred:Function},data(){var n,e;return{addons:((n=this.position)==null?void 0:n.addons)||[],ingredients:((e=this.position)==null?void 0:e.ingredients)||[]}}},Gt={class:"edits"},Kt={class:"edit__engredients"};function Xt(n,e,t,r,d,s){const i=zt,u=Ut;return c(),a("div",Gt,[d.addons.length!=0?(c(),m(i,{key:0,addons:d.addons,addAddon:t.addAddon,delAddon:t.delAddon},null,8,["addons","addAddon","delAddon"])):v("",!0),o("div",Kt,[(c(!0),a(f,null,g(d.ingredients,h=>(c(),m(u,{key:h.id,ingredient:h,addIngred:t.addIngred,delIngred:t.delIngred},null,8,["ingredient","addIngred","delIngred"]))),128))])])}const Zt=l(Wt,[["render",Xt]]),tn={props:{cost:Number,count:Number,plusCount:Function,minusCount:Function,addToBusket:Function},data(){return{}},computed:{totalCost(){var n=this.cost*this.count;return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}}},nn={class:"button-bar"},en={class:"button-bar__text"},on={class:"button-bar__control"},sn={class:"button-bar__count"},dn=["disabled"],cn={class:"button-bar__count-text"};function an(n,e,t,r,d,s){return c(),a("div",nn,[o("p",en,[x("Итого: "),o("b",null,_(s.totalCost),1)]),o("div",on,[o("div",sn,[o("button",{onClick:e[0]||(e[0]=(...i)=>t.minusCount&&t.minusCount(...i)),class:b(`button-bar__count-btn ${t.count===1?"button-bar__count-btn_dis":""}`),disabled:t.count===1},"-",10,dn),o("p",cn,_(t.count)+" шт",1),o("button",{onClick:e[1]||(e[1]=(...i)=>t.plusCount&&t.plusCount(...i)),class:"button-bar__count-btn"},"+")]),o("button",{onClick:e[2]||(e[2]=(...i)=>t.addToBusket&&t.addToBusket(...i)),class:"button-bar__btn"},"Добавить")])])}const rn=l(tn,[["render",an]]),_n={data(){return{touchStart:0,orderAddons:[],orderIngredients:[],count:1}},props:{position:Object,isOpen:Boolean,onClose:Function},methods:{addAddon(n){this.orderAddons.push(n)},delAddon(n){const e=this.orderAddons.findIndex(t=>t.id===n.id);this.orderAddons.splice(e,1)},addIngred(n){this.orderIngredients.push(n)},delIngred(n){const e=this.orderIngredients.findIndex(t=>t.id===n.id);this.orderIngredients.splice(e,1)},plusCount(){this.count+=1},minusCount(){this.count-=1},clearData(){this.orderAddons=[],this.orderIngredients=[],this.count=1},closePopup(n){this.onClose(),this.clearData(),setTimeout(()=>{n.style.top="auto",n.style.bottom=0},1e3)},addToBusket(){const{addItem:n}=A(),e=document.querySelector(".cafe-popup"),t={id:this.orderItem.id,name:this.orderItem.name,cost:this.orderItem.cost,count:this.count,totalCost:this.totalCost,addons:this.orderAddons,ingredients:this.orderIngredients,image:this.orderItem.image};n(t),this.clearData(),this.closePopup(e)},onTouchStart(n){console.log(n),this.touchStart=n.changedTouches[0].clientY},onTouchMove(n,e){var t=e.targetTouches[0];t.clientY>=this.touchStart&&(n.style.bottom=0-(t.clientY-this.touchStart)+"px")},onTouchEnd(n,e){var t=e.changedTouches[0];t.clientY>150+this.touchStart?this.closePopup(n):(n.style.top="auto",n.style.bottom=0)}},computed:{totalCost(){let n=this.orderItem.cost;return this.orderAddons.forEach(e=>{n+=e.cost}),this.orderIngredients.forEach(e=>{n+=e.cost}),n},orderItem(){return{id:this.position.id,name:this.position.name,cost:this.position.cost,image:this.position.image}}},mounted(){const n=document.querySelector(".cafe-popup__drag-zone"),e=document.querySelector(".cafe-popup");e.style.bottom=0,n.addEventListener("touchstart",t=>{this.onTouchStart(t)}),n.addEventListener("touchmove",t=>{this.onTouchMove(e,t)}),n.addEventListener("touchend",t=>{this.onTouchEnd(e,t)})},beforeUnmount(){const n=document.querySelector(".cafe-popup__drag-zone"),e=document.querySelector(".cafe-popup");n.removeEventListener("touchstart",t=>{this.onTouchStart(t)}),n.removeEventListener("touchmove",t=>{this.onTouchMove(e,t)}),n.removeEventListener("touchend",t=>{this.onTouchEnd(e,t)})}},un=o("div",{class:"cafe-popup__drag-zone"},[o("div",{class:"cafe-popup__drag-bar"})],-1),ln={class:"cafe-popup__content"};function hn(n,e,t,r,d,s){var C,$;const i=yt,u=Zt,h=rn;return c(),a("div",{class:b(`cafe-popup ${t.isOpen?"cafe-popup_show":""}`)},[un,o("div",ln,[p(i,{position:t.position},null,8,["position"]),(C=t.position)!=null&&C.addons||($=t.position)!=null&&$.ingredients?(c(),m(u,{key:0,position:t.position,addAddon:s.addAddon,delAddon:s.delAddon,addIngred:s.addIngred,delIngred:s.delIngred},null,8,["position","addAddon","delAddon","addIngred","delIngred"])):v("",!0),p(h,{cost:s.totalCost,count:d.count,plusCount:s.plusCount,minusCount:s.minusCount,addToBusket:s.addToBusket},null,8,["cost","count","plusCount","minusCount","addToBusket"])])],2)}const pn=l(_n,[["render",hn]]),mn={data(){return{cafe:{},isPopup:!1,position:{}}},computed:{busket(){const{getBusket:n}=A();return n||[]},totalCost(){let n=0;return this.busket.forEach(e=>{n+=e.totalCost*e.count}),n}},methods:{tooglePopup(){this.isPopup=!this.isPopup,this.isPopup?document.body.style.overflow="hidden":document.body.style.overflow="auto"},openPosition(n){this.position=n,this.tooglePopup()}},async beforeMount(){const{setCurCafe:n}=T(),{setLoader:e}=w(),t=S({});let r=JSON.parse((this._.provides[B]||this.$route).query.cafeId);e(!0),await I.getCafeId(r);const{data:d}=await I.getCafeId(r);t.value=await(d==null?void 0:d.value),e(!1),n(t.value),this.cafe=t.value}},fn={class:"cafe"};function gn(n,e,t,r,d,s){const i=y,u=V,h=pt,C=Ct,$=pn;return c(),a("div",fn,[p(i),p(u,{info:d.cafe},null,8,["info"]),p(h,{menu:d.cafe.menu,onOpenPos:s.openPosition},null,8,["menu","onOpenPos"]),s.busket.length>0?(c(),m(C,{key:0,totalCost:s.totalCost},null,8,["totalCost"])):v("",!0),p($,{onClose:s.tooglePopup,isOpen:d.isPopup,position:d.position},null,8,["onClose","isOpen","position"]),d.isPopup?(c(),a("div",{key:1,class:b(`cafe__bg ${d.isPopup?"cafe__bg_show":""}`)},null,2)):v("",!0)])}const An=l(mn,[["render",gn]]);export{An as default};
